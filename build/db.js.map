{"version":3,"sources":["../server/db.js"],"names":[],"mappings":";;AAAA,IAAM,IAAI,QAAQ,WAAR,CAAJ;;AAEN,IAAI,UAAU,SAAV,OAAU,GAAY;AACxB,SAAO,EAAE,OAAF,CAAU;AACf,UAAM,WAAN,EAAmB,MAAM,KAAN,EAAa,IAAI,OAAJ;GAD3B,CAAP,CADwB;CAAZ;;AAMd,IAAI,4BAA4B,SAA5B,yBAA4B,CAAU,OAAV,EAAmB;AACjD,SAAO,UAAU,IAAV,CAAe,UAAS,IAAT,EAAe;AACnC,WAAO,EAAE,KAAF,CAAQ,UAAR,EAAoB,OAApB,CAA4B,EAAC,OAAO,EAAE,IAAF,CAAO,eAAP,CAAP,EAA7B,EAA8D,MAA9D,CAAqE,EAAE,GAAF,CAAM,QAAN,EAAgB,EAAhB,CAAmB,CAAnB,CAArE,EAA4F,KAA5F,CAAkG,OAAlG,EAA2G,OAA3G,CAAmH,EAAC,gBAAe,IAAf,EAAoB,cAAa,IAAb,EAAkB,gBAAe,IAAf,EAAoB,QAAO,KAAP,EAA9K,EAA6L,GAA7L,CAAiM,IAAjM,CAAP,CADmC;GAAf,CAAtB,CADiD;CAAnB;;AAMhC,IAAI,0BAA0B,SAA1B,uBAA0B,CAAU,OAAV,EAAmB;AAC/C,SAAO,UAAU,IAAV,CAAe,UAAS,IAAT,EAAe;AACnC,WAAO,EAAE,KAAF,CAAQ,QAAR,EAAkB,OAAlB,CAA0B,EAAC,OAAO,EAAE,IAAF,CAAO,eAAP,CAAP,EAA3B,EAA4D,MAA5D,CAAmE,EAAE,GAAF,CAAM,QAAN,EAAgB,EAAhB,CAAmB,CAAnB,CAAnE,EAA0F,KAA1F,CAAgG,OAAhG,EAAyG,OAAzG,CAAiH,EAAC,gBAAe,IAAf,EAAoB,cAAa,IAAb,EAAkB,gBAAe,IAAf,EAAoB,QAAO,KAAP,EAA5K,EAA2L,GAA3L,CAA+L,IAA/L,CAAP,CADmC;GAAf,CAAtB,CAD+C;CAAnB;;AAM9B,IAAI,mBAAmB,SAAnB,gBAAmB,CAAS,OAAT,EAAkB;AACvC,SAAO,UAAU,IAAV,CAAe,UAAS,IAAT,EAAe;AACnC,WAAO,EAAE,KAAF,CAAQ,QAAR,EAAkB,OAAlB,CAA0B,EAAC,OAAO,eAAP,EAA3B,EAAoD,MAApD,CAA2D,EAAE,GAAF,CAAM,QAAN,EAAgB,EAAhB,CAAmB,CAAnB,CAA3D,EAAkF,KAAlF,CAAwF,OAAxF,EAAiG,OAAjG,CAAyG,EAAC,gBAAe,IAAf,EAAoB,cAAa,IAAb,EAAkB,gBAAe,IAAf,EAAoB,QAAO,KAAP,EAApK,EAAmL,GAAnL,CAAuL,IAAvL,CAAP,CADmC;GAAf,CAAtB,CADuC;CAAlB;;AAMvB,IAAI,qBAAqB,SAArB,kBAAqB,CAAS,OAAT,EAAkB;AACzC,SAAO,UAAU,IAAV,CAAe,UAAS,IAAT,EAAe;AACnC,WAAO,EAAE,KAAF,CAAQ,UAAR,EAAoB,OAApB,CAA4B,EAAC,OAAO,eAAP,EAA7B,EAAsD,MAAtD,CAA6D,EAAE,GAAF,CAAM,QAAN,EAAgB,EAAhB,CAAmB,CAAnB,CAA7D,EAAoF,KAApF,CAA0F,OAA1F,EAAmG,OAAnG,CAA2G,EAAC,gBAAe,IAAf,EAAoB,cAAa,IAAb,EAAkB,gBAAe,IAAf,EAAoB,QAAO,KAAP,EAAtK,EAAqL,GAArL,CAAyL,IAAzL,CAAP,CADmC;GAAf,CAAtB,CADyC;CAAlB;;AAMzB,QAAQ,OAAR,GAAkB,OAAlB;AACA,QAAQ,yBAAR,GAAoC,yBAApC;AACA,QAAQ,kBAAR,GAA6B,kBAA7B;AACA,QAAQ,uBAAR,GAAkC,uBAAlC;AACA,QAAQ,gBAAR,GAA2B,gBAA3B","file":"db.js","sourcesContent":["const r = require('rethinkdb');\r\n\r\nvar connect = function () {\r\n  return r.connect({\r\n    host: 'localhost', port: 28015, db: \"celeb\"\r\n  });\r\n}\r\n\r\nvar getLatestApprovedMessages = function (maxRows) {\r\n  return connect().then(function(conn) {\r\n    return r.table(\"Messages\").orderBy({index: r.desc('statusAndDate')}).filter(r.row(\"status\").eq(1)).limit(maxRows).changes({includeInitial:true,includeTypes:true,includeOffsets:true,squash:false}).run(conn);\r\n  });\r\n}\r\n\r\nvar getLatestApprovedImages = function (maxRows) {\r\n  return connect().then(function(conn) {\r\n    return r.table(\"Images\").orderBy({index: r.desc('statusAndDate')}).filter(r.row(\"status\").eq(1)).limit(maxRows).changes({includeInitial:true,includeTypes:true,includeOffsets:true,squash:false}).run(conn);\r\n  });\r\n}\r\n\r\nvar getPendingImages = function(maxRows) {\r\n  return connect().then(function(conn) {\r\n    return r.table(\"Images\").orderBy({index: 'statusAndDate'}).filter(r.row(\"status\").eq(0)).limit(maxRows).changes({includeInitial:true,includeTypes:true,includeOffsets:true,squash:false}).run(conn);\r\n  });\r\n}\r\n\r\nvar getPendingMessages = function(maxRows) {\r\n  return connect().then(function(conn) {\r\n    return r.table(\"Messages\").orderBy({index: 'statusAndDate'}).filter(r.row(\"status\").eq(0)).limit(maxRows).changes({includeInitial:true,includeTypes:true,includeOffsets:true,squash:false}).run(conn);\r\n  });\r\n}\r\n\r\nexports.connect = connect;\r\nexports.getLatestApprovedMessages = getLatestApprovedMessages;\r\nexports.getPendingMessages = getPendingMessages;\r\nexports.getLatestApprovedImages = getLatestApprovedImages;\r\nexports.getPendingImages = getPendingImages;\r\n"]}